{
  "id": "unstake_lp_tokens",
  "category": "defi_operations",
  "subcategory": "staking_farming",
  "difficulty": "medium",
  "title": "Unstake LP Tokens from Farming Pool",
  "description": [
    "Withdraw (unstake) LP tokens from a farming pool. This operation retrieves your staked LP tokens back to your wallet.",
    "",
    "Technical context:",
    "- Uses SimpleRewardPool contract's withdraw() function",
    "- Function signature: withdraw(uint256 _amount)",
    "- The withdraw function will also automatically harvest any pending rewards",
    "- LP tokens are returned to the user's wallet",
    "- Staked balance in the pool decreases by the withdrawal amount",
    "",
    "Key considerations:",
    "- Amount must not exceed the staked balance",
    "- Amount must be in wei (18 decimals for LP tokens)",
    "- Can withdraw partial or full staked amount",
    "- The pool automatically harvests rewards during withdrawal",
    "",
    "Implementation steps:",
    "1. Query current staked amount: rewardPool.userInfo(user_address)",
    "2. Ensure unstake amount <= staked amount",
    "3. Call withdraw: rewardPool.withdraw(amountInWei)",
    "4. Verify LP token balance increased by unstake amount",
    "5. Verify staked amount decreased by unstake amount"
  ],
  "natural_language_templates": [
    "Unstake {unstake_amount} USDT/BUSD LP tokens from the SimpleRewardPool",
    "Withdraw {unstake_amount} LP tokens from the simple_reward_pool contract",
    "Remove {unstake_amount} LP tokens from the reward pool staking",
    "Unstake {unstake_amount} USDT/BUSD LP tokens from the reward distribution pool"
  ],
  "parameters": {
    "pool_address": {
      "type": "address",
      "role": "staking_contract",
      "description": "SimpleRewardPool contract address",
      "generation": {
        "method": "from_env",
        "env_key": "simple_reward_pool_address"
      }
    },
    "unstake_amount": {
      "type": "number",
      "unit": "LP_token",
      "role": "withdrawal_amount",
      "description": "Amount of LP tokens to unstake",
      "generation": {
        "method": "random",
        "min": 0.2,
        "max": 0.4,
        "decimals": 1
      }
    },
    "lp_token_address": {
      "type": "address",
      "role": "staked_token",
      "description": "LP token contract address (USDT/BUSD pair)",
      "generation": {
        "method": "fixed",
        "value": "0x7EFaEf62fDdCCa950418312c6C91Aef321375A00"
      }
    },
    "user_address": {
      "type": "address",
      "role": "staker",
      "description": "User's wallet address",
      "generation": {
        "method": "from_env",
        "env_key": "test_address"
      }
    }
  },
  "pre_conditions": [
    {
      "type": "staked_balance_check",
      "pool": "{pool_address}",
      "user": "{user_address}",
      "min_staked": "{unstake_amount}",
      "description": "User must have sufficient staked balance"
    }
  ],
  "post_conditions": [
    {
      "type": "transaction_success",
      "weight": 0.3,
      "description": "Withdraw transaction executed successfully"
    },
    {
      "type": "token_balance_change",
      "weight": 0.4,
      "token": "{lp_token_address}",
      "address": "{user_address}",
      "expected_change": "+{unstake_amount}",
      "tolerance": "0.01",
      "description": "LP token balance increased correctly"
    },
    {
      "type": "staked_balance_change",
      "weight": 0.3,
      "pool": "{pool_address}",
      "user": "{user_address}",
      "expected_change": "-{unstake_amount}",
      "tolerance": "0.01",
      "description": "Staked amount decreased correctly"
    }
  ],
  "metadata": {
    "tags": [
      "unstake",
      "withdraw",
      "farming",
      "lp-tokens",
      "defi",
      "staking"
    ],
    "estimated_gas": 150000,
    "requires_contract": true,
    "network": "mainnet",
    "contract_type": "SimpleRewardPool",
    "notes": [
      "The withdraw function also harvests pending rewards automatically",
      "Focus is on LP token withdrawal, rewards are a side effect",
      "Partial withdrawal is supported"
    ]
  },
  "version": "2.0.0",
  "blockchain": {
    "chain": "BSC",
    "network": "mainnet"
  }
}

